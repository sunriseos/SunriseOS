<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `unschedule` fn in crate `sunrise_kernel`."><meta name="keywords" content="rust, rustlang, rust-lang, unschedule"><title>sunrise_kernel::scheduler::unschedule - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css"><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script src="../../storage.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="shortcut icon" href="../../favicon.ico"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc fn"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../../sunrise_kernel/index.html'><div class='logo-container'><img src='../../rust-logo.png' alt='logo'></div></a><div class="sidebar-elems"><p class='location'><a href='../index.html'>sunrise_kernel</a>::<wbr><a href='index.html'>scheduler</a></p><script>window.sidebarCurrent = {name: 'unschedule', ty: 'fn', relpath: ''};</script><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../../settings.html"><img src="../../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../../src/sunrise_kernel/scheduler.rs.html#158-181' title='goto source code'>[src]</a></span><span class='in-band'>Function <a href='../index.html'>sunrise_kernel</a>::<wbr><a href='index.html'>scheduler</a>::<wbr><a class="fn" href=''>unschedule</a></span></h1><pre class='rust fn'>pub fn unschedule&lt;'a, LOCK, GUARD&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;lock: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a </a>LOCK, <br>&nbsp;&nbsp;&nbsp;&nbsp;guard: GUARD<br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;GUARD, <a class="struct" href="../../sunrise_kernel/error/struct.UserspaceError.html" title="struct sunrise_kernel::error::UserspaceError">UserspaceError</a>&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;LOCK: <a class="trait" href="../../sunrise_kernel/sync/trait.Lock.html" title="trait sunrise_kernel::sync::Lock">Lock</a>&lt;'a, GUARD&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;GUARD: 'a,&nbsp;</span></pre><div class='docblock'><p>Removes the current thread from the schedule queue, and schedule.</p>
<p>The passed lock will remain locked until the thread is safely removed from the schedule queue.
In other words, event handling code should wait for that lock to be dropped before attempting
to call <code>add_to_schedule_queue</code>.</p>
<p>The reason behind this behavior is that <code>add_to_schedule_queue</code> checks if a thread is currently
in the schedule queue, before adding it in. It does the check by checking if the thread is
either in the list of threads to run, or if it's the currently running one and in a Running
state. The lock will be dropped once the thread is transitioned to the Stopped state, allowing
<code>add_to_schedule_queue</code> to work again.</p>
<p>It will be relocked just before the thread starts running again. Specifically, it will be
relocked when CURRENT_THREAD is set back to the current thread, but before its state is
changed back to Running. This allows using SpinLockIRQs as a lock.</p>
<p>The lock should be used to avoid race conditions between registering for an event, and unscheduling.</p>
<p>The current thread will not be ran again unless it was registered for rescheduling.</p>
</div></section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../../";window.currentCrate = "sunrise_kernel";</script><script src="../../main.js"></script><script defer src="../../search-index.js"></script></body></html>